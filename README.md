# Kids Reading Recognition Web Service

An interactive web application that helps children aged 11-13 improve their reading skills through real-time speech recognition, lenient word matching, and comprehension quizzes.

## Features

- **Real-time Speech Recognition**: Uses Azure Speech Services to recognize children's speech
- **Lenient Word Matching**: Prioritizes recognition over perfect pronunciation (70% threshold)
- **Progressive Highlighting**: Words turn green as they're successfully read
- **Encouraging Feedback**: Positive reinforcement at every milestone
- **Haptic Feedback**: Success vibrations on Android devices
- **Auto-Generated Quizzes**: Comprehension questions generated by AI
- **Kid-Friendly UI**: Large text, colorful design, intuitive navigation

## Tech Stack

### Frontend
- **Next.js 14+** with App Router
- **TypeScript**
- **Tailwind CSS** for styling
- **Web Audio API** for microphone capture
- **WebSocket** for real-time audio streaming

### Backend
- **FastAPI** (Python)
- **Azure Speech Services** for transcription
- **OpenAI GPT-4o** or **Claude** for quiz generation
- **Fuzzy matching** with Soundex, Metaphone, and Levenshtein algorithms

## Architecture

```
┌─────────────────────────────────────────────────┐
│                  Browser                        │
│  ┌──────────────────────────────────────────┐  │
│  │  Web Audio API (Microphone Capture)     │  │
│  └──────────────────┬───────────────────────┘  │
│                     │ WebSocket                 │
└─────────────────────┼───────────────────────────┘
                      │
┌─────────────────────▼───────────────────────────┐
│              FastAPI Backend                    │
│  ┌──────────────────────────────────────────┐  │
│  │  Speech Recognition (Azure)              │  │
│  │  Fuzzy Word Matching (70% threshold)     │  │
│  │  Quiz Generation (GPT-4o/Claude)         │  │
│  └──────────────────────────────────────────┘  │
└─────────────────────────────────────────────────┘
```

## Installation & Setup

### Prerequisites

- Node.js 18+ and npm
- Python 3.9+
- Azure Speech Services account
- OpenAI API key or Anthropic API key

### 1. Clone the Repository

```bash
cd /Users/baiamanbazarbaev/Desktop/late_night_coding
```

### 2. Frontend Setup

```bash
cd frontend
npm install
```

Create `.env.local`:

```env
NEXT_PUBLIC_API_URL=http://localhost:8000
```

### 3. Backend Setup

```bash
cd backend
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate
pip install -r requirements.txt
```

Create `.env` file from `.env.example`:

```bash
cp .env.example .env
```

Edit `.env` with your credentials:

```env
# Azure Speech Services (Required)
AZURE_SPEECH_KEY=your_azure_key_here
AZURE_SPEECH_REGION=eastus

# OpenAI API (for quiz generation)
OPENAI_API_KEY=your_openai_key_here

# Or use Anthropic Claude
# ANTHROPIC_API_KEY=your_anthropic_key_here

# Word matching threshold (0.0 - 1.0)
WORD_MATCH_THRESHOLD=0.70
```

### 4. Getting API Keys

#### Azure Speech Services
1. Go to [Azure Portal](https://portal.azure.com)
2. Create a "Speech Services" resource
3. Get your key and region from "Keys and Endpoint"
4. Free tier: 5 hours/month of transcription

#### OpenAI API
1. Go to [OpenAI Platform](https://platform.openai.com)
2. Create an API key
3. Add credits to your account
4. Estimated cost: ~$0.015 per quiz (GPT-4o)

#### Anthropic Claude (Alternative)
1. Go to [Anthropic Console](https://console.anthropic.com)
2. Create an API key
3. Estimated cost: ~$0.001 per quiz (Claude 3 Haiku)

## Running the Application

### Development Mode

**Terminal 1 - Backend:**
```bash
cd backend
source venv/bin/activate
python main.py
```

Backend runs on: http://localhost:8000

**Terminal 2 - Frontend:**
```bash
cd frontend
npm run dev
```

Frontend runs on: http://localhost:3000

### Access the App

Open your browser and navigate to:
```
http://localhost:3000
```

## Project Structure

```
├── frontend/                  # Next.js frontend
│   ├── app/
│   │   ├── page.tsx          # Home page (story selection)
│   │   ├── reading/[textId]/ # Reading interface
│   │   ├── quiz/[sessionId]/ # Quiz page
│   │   └── results/[sessionId]/ # Results page
│   ├── components/
│   │   ├── AudioRecorder.tsx # Microphone capture
│   │   ├── TextDisplay.tsx   # Word highlighting
│   │   ├── Quiz.tsx          # Quiz interface
│   │   └── EncouragementFeedback.tsx
│   └── lib/                  # Utilities
│
├── backend/                   # FastAPI backend
│   ├── main.py               # Main API server
│   ├── services/
│   │   ├── speech_recognition.py  # Azure integration
│   │   ├── word_matcher.py        # Fuzzy matching
│   │   └── quiz_generator.py      # LLM integration
│   └── requirements.txt
│
└── README.md
```

## How It Works

### 1. Reading Flow

1. **User selects a story** from the home page
2. **Microphone activates** via Web Audio API
3. **Audio streams** to backend via WebSocket
4. **Azure transcribes** the speech in real-time
5. **Fuzzy matching** compares spoken vs. expected words
6. **Words turn green** when recognized (70%+ match)
7. **Encouraging feedback** shown at 25%, 50%, 75%, 100%

### 2. Word Matching Logic

The system uses multiple algorithms to match words leniently:

- **Exact match**: 100% confidence
- **Common variants**: 95% confidence (e.g., "sed" for "said")
- **Phonetic matching**: Soundex, Metaphone (85%+ = pass)
- **Edit distance**: Levenshtein similarity (70%+ = pass)
- **Fuzzy matching**: Token-based comparison (70%+ = pass)

**Example:**
- Expected: "adventure"
- Spoken: "adventur" → ✅ Pass (87% similarity)
- Spoken: "adventer" → ✅ Pass (75% similarity)
- Spoken: "house" → ❌ Fail (25% similarity)

### 3. Quiz Generation

After completing a reading:
1. Text is sent to LLM (GPT-4o or Claude)
2. AI generates 5 age-appropriate questions
3. Multiple-choice format with 4 options
4. Mix of literal and inferential questions
5. Results shown with encouraging feedback

## Customization

### Adjust Word Matching Threshold

Edit `backend/.env`:

```env
# More lenient (accept more variations)
WORD_MATCH_THRESHOLD=0.60

# More strict (require closer pronunciation)
WORD_MATCH_THRESHOLD=0.85
```

### Add New Reading Texts

Edit `frontend/app/page.tsx` and `frontend/app/reading/[textId]/page.tsx`:

```typescript
const readingTexts = {
  'new-story-id': 'Your new story text here...',
  // ...
}
```

### Change Quiz Questions Count

Edit `backend/main.py`:

```python
questions = await quiz_generator.generate_questions(
    text=request.text,
    num_questions=5,  # Change this number
    age_group="11-13"
)
```

## Troubleshooting

### Microphone Not Working

- **Check browser permissions**: Chrome/Firefox need explicit permission
- **Use HTTPS**: Some browsers require HTTPS (except localhost)
- **Check microphone access**: System settings → Privacy

### WebSocket Connection Failed

- **Backend not running**: Start backend with `python main.py`
- **Port already in use**: Change port in `backend/main.py`
- **Firewall**: Allow connections on port 8000

### Azure Speech Errors

- **Invalid credentials**: Check `AZURE_SPEECH_KEY` and `AZURE_SPEECH_REGION`
- **Quota exceeded**: Free tier has 5 hours/month limit
- **Network issues**: Check internet connection

### Quiz Not Generating

- **Missing API key**: Add `OPENAI_API_KEY` or `ANTHROPIC_API_KEY`
- **API quota**: Check your API usage/credits
- **Fallback**: App uses sample questions if API fails

## Cost Estimates

### For 1000 Active Users/Month
(Assuming 10 reading sessions per user)

- **Azure Speech**: $50-100/month
- **OpenAI GPT-4o**: $150/month (10,000 quizzes)
- **Anthropic Claude Haiku**: $10/month (10,000 quizzes)
- **Hosting**: $50/month (Vercel + Cloud provider)

**Total: $250-300/month**

### Cost Optimization

- Use Claude 3 Haiku instead of GPT-4o (10x cheaper)
- Cache frequently generated quizzes
- Implement quiz question database
- Use Azure's committed tier pricing

## Browser Compatibility

### Fully Supported
- Chrome 88+ (desktop & Android)
- Edge 88+
- Firefox 85+

### Partial Support
- Safari 14+ (no haptic feedback on iOS)
- Mobile browsers (microphone requires HTTPS)

### Required Features
- Web Audio API
- WebSocket support
- ES6+ JavaScript

## Future Enhancements

- [ ] Save reading progress to database
- [ ] User accounts and profiles
- [ ] Reading history and analytics
- [ ] Difficulty level adaptation
- [ ] Multiplayer reading challenges
- [ ] Parent/teacher dashboard
- [ ] Offline mode support
- [ ] Multiple language support
- [ ] Voice customization for feedback
- [ ] Gamification with points/badges

## Contributing

Contributions are welcome! Please:

1. Fork the repository
2. Create a feature branch
3. Make your changes
4. Test thoroughly
5. Submit a pull request

## License

This project is for educational purposes.

## Support

For issues or questions:
- Check the troubleshooting section
- Review Azure and OpenAI documentation
- Open an issue on GitHub

## Acknowledgments

- Azure Speech Services for children's voice recognition
- OpenAI and Anthropic for quiz generation
- Next.js and FastAPI communities
- Fuzzy matching libraries (jellyfish, fuzzywuzzy)
